# Heatmap Regression for Coastal Landmark Localisation - Configuration

data:
  images_dir: "data/images"
  annotations_file: "data/annotations.json"
  input_width: 512
  input_height: 384
  output_width: 128
  output_height: 96
  num_landmarks: 7

model:
  backbone: "resnet18"
  pretrained: true
  decoder_channels: [256, 128, 64]
  output_activation: "sigmoid"

heatmap:
  sigma: 4.0

loss:
  type: "weighted_mse"
  alpha: 5.0  # weight factor for weighted MSE
  coord_weight: 5.0  # coordinate regression loss weight

training:
  batch_size: 8
  epochs: 300
  freeze_encoder_epochs: 5
  encoder_lr: 1.0e-5
  decoder_lr: 1.0e-4
  weight_decay: 1.0e-4
  lr_scheduler: "plateau"  # "plateau" or "cosine"
  plateau_patience: 10
  plateau_factor: 0.5
  early_stopping_patience: 25
  use_mixed_precision: true

data_split:
  train_ratio: 0.70
  val_ratio: 0.15
  test_ratio: 0.15
  random_seed: 42

augmentation:
  enabled: true
  rotation_limit: 20
  scale_limit: 0.2
  translate_limit: 0.15
  brightness_limit: 0.3
  contrast_limit: 0.3
  saturation_limit: 0.3
  hue_shift_limit: 10
  blur_limit: 5
  noise_var_limit: 0.02
  horizontal_flip: false  # set true only if scene is symmetric

inference:
  soft_argmax: true
  local_window_size: 11  # window around center-of-mass for local soft-argmax

refinement:
  enabled: true
  reference_image: "data/images/1577820840.Wed.Jan.01_05_34_00.AEST.2020.manly.snap.CherylWhite.jpg"
  reference_mat: "1577820840.Wed.Jan.01_05_34_00.AEST.2020.manly.plan.CherylWhite.mat"
  template_size: 128
  search_size: 512
  subpixel: true
  grayscale: true
  min_confidence: 0.3

homography:
  reference_image: "data/images/1577820840.Wed.Jan.01_05_34_00.AEST.2020.manly.snap.CherylWhite.jpg"
  reference_mat: "1577820840.Wed.Jan.01_05_34_00.AEST.2020.manly.plan.CherylWhite.mat"
  mask_path: "data/masks/manly_static_mask.png"
  model:
    backbone: "resnet18"
    dropout: 0.5
  working_width: 512
  working_height: 384
  synthetic:
    max_displacement: 32.0
    samples_per_epoch: 10000
    batch_size: 8
    epochs: 200
  output:
    checkpoint_dir: "checkpoints/homography"

output:
  checkpoint_dir: "checkpoints"
  log_dir: "logs"
  results_dir: "results"
